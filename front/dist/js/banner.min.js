function Banners(){}Banners.prototype.loadData=function(){var c=this;xfzajax.get({url:"/cms/banner_list/",success:function(n){if(200===n.code)for(var e=n.data,a=0;a<e.length;a++){var t=e[a],r=template("banner-item",{banner:t}),i=$(".banner-list-group");i.append(r);var o=i.find(".banner-item:last");c.addImageSelectEvent(o),c.addRemoveBannerEvent(o),c.addSaveBannerEvent(o)}}})},Banners.prototype.listenAddBannerEvent=function(){var t=this;$("#add-banner-btn").click(function(){var n=template("banner-item"),e=$(".banner-list-group");e.prepend(n);var a=e.find(".banner-item:first");t.addImageSelectEvent(a),t.addRemoveBannerEvent(a),t.addSaveBannerEvent(a)})},Banners.prototype.addImageSelectEvent=function(n){var a=n.find(".thumbnail"),e=n.find(".image-input");a.click(function(){e.click()}),e.change(function(){var n=this.files[0],e=new FormData;e.append("file",n),xfzajax.post({url:"/cms/upload_file/",data:e,processData:!1,contentType:!1,success:function(n){if(200===n.code){var e=n.data.url;a.attr("src",e)}}})})},Banners.prototype.addRemoveBannerEvent=function(n){n.find(".close-btn").click(function(){console.log("close bannerITem"),n.remove()})},Banners.prototype.addSaveBannerEvent=function(n){var e=n.find(".save-btn"),t=n.find(".thumbnail"),r=n.find("input[name='priority']"),i=n.find("input[name='link_to']"),o=n.find('span[class="priority"]');e.click(function(){var n=t.attr("src"),e=r.val(),a=i.val();xfzajax.post({url:"/cms/add_banner/",data:{image_url:n,priority:e,link_to:a},success:function(n){if(200===n.code){n.data.banner_id;o.text("优先级："+e),window.messageBox.showSuccess("轮播图添加完成！")}}})})},Banners.prototype.run=function(){this.listenAddBannerEvent(),this.loadData()},$(function(){(new Banners).run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhbm5lci5qcyJdLCJuYW1lcyI6WyJCYW5uZXJzIiwicHJvdG90eXBlIiwibG9hZERhdGEiLCJzZWxmIiwidGhpcyIsInhmemFqYXgiLCJnZXQiLCJ1cmwiLCJzdWNjZXNzIiwicmVzdWx0IiwiYmFubmVycyIsImkiLCJsZW5ndGgiLCJiYW5uZXIiLCJ0cGwiLCJ0ZW1wbGF0ZSIsImJhbm5lckxpc3RHcm91cCIsIiQiLCJhcHBlbmQiLCJiYW5uZXJJdGVtIiwiZmluZCIsImFkZEltYWdlU2VsZWN0RXZlbnQiLCJhZGRSZW1vdmVCYW5uZXJFdmVudCIsImFkZFNhdmVCYW5uZXJFdmVudCIsImxpc3RlbkFkZEJhbm5lckV2ZW50IiwiY2xpY2siLCJwcmVwZW5kIiwiaW1hZ2UiLCJpbWFnZUlucHV0IiwiY2hhbmdlIiwiZmlsZSIsImZpbGVzIiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsInBvc3QiLCJkYXRhIiwicHJvY2Vzc0RhdGEiLCJjb250ZW50VHlwZSIsImF0dHIiLCJjb25zb2xlIiwibG9nIiwicmVtb3ZlIiwic2F2ZUJ0biIsImltYWdlVGFnIiwicHJpb3JpdHlUYWciLCJsaW5rdG9UYWciLCJwcmlvcml0eVNwYW4iLCJpbWFnZV91cmwiLCJwcmlvcml0eSIsInZhbCIsImxpbmtfdG8iLCJ0ZXh0Iiwid2luZG93IiwibWVzc2FnZUJveCIsInNob3dTdWNjZXNzIiwicnVuIl0sIm1hcHBpbmdzIjoiQUFBQSxTQUFTQSxXQUlUQSxRQUFRQyxVQUFVQyxTQUFXLFdBQ3pCLElBQUlDLEVBQU9DLEtBQ1hDLFFBQVFDLElBQUksQ0FDUkMsSUFBTyxvQkFDUEMsUUFBVyxTQUFVQyxHQUNqQixHQUF1QixNQUFuQkEsRUFBYSxLQUViLElBREEsSUFBSUMsRUFBVUQsRUFBYSxLQUNsQkUsRUFBSSxFQUFHQSxFQUFJRCxFQUFRRSxPQUFRRCxJQUFLLENBQ3JDLElBQUlFLEVBQVNILEVBQVFDLEdBQ2pCRyxFQUFNQyxTQUFTLGNBQWUsQ0FBQ0YsT0FBVUEsSUFDekNHLEVBQWtCQyxFQUFFLHNCQUN4QkQsRUFBZ0JFLE9BQU9KLEdBQ3ZCLElBQUlLLEVBQWFILEVBQWdCSSxLQUFLLHFCQUN0Q2pCLEVBQUtrQixvQkFBb0JGLEdBQ3pCaEIsRUFBS21CLHFCQUFxQkgsR0FDMUJoQixFQUFLb0IsbUJBQW1CSixRQVM1Q25CLFFBQVFDLFVBQVV1QixxQkFBdUIsV0FDckMsSUFBSXJCLEVBQU9DLEtBQ0VhLEVBQUUsbUJBQ1JRLE1BQU0sV0FDVCxJQUFJWCxFQUFNQyxTQUFTLGVBQ2ZDLEVBQWtCQyxFQUFFLHNCQUN4QkQsRUFBZ0JVLFFBQVFaLEdBRXhCLElBQUlLLEVBQWFILEVBQWdCSSxLQUFLLHNCQUN0Q2pCLEVBQUtrQixvQkFBb0JGLEdBQ3pCaEIsRUFBS21CLHFCQUFxQkgsR0FDMUJoQixFQUFLb0IsbUJBQW1CSixNQUloQ25CLFFBQVFDLFVBQVVvQixvQkFBc0IsU0FBVUYsR0FDOUMsSUFBSVEsRUFBUVIsRUFBV0MsS0FBSyxjQUN4QlEsRUFBYVQsRUFBV0MsS0FBSyxnQkFFakNPLEVBQU1GLE1BQU0sV0FDUkcsRUFBV0gsVUFHZkcsRUFBV0MsT0FBTyxXQUNkLElBQUlDLEVBQU8xQixLQUFLMkIsTUFBTSxHQUNsQkMsRUFBVyxJQUFJQyxTQUNuQkQsRUFBU2QsT0FBTyxPQUFRWSxHQUN4QnpCLFFBQVE2QixLQUFLLENBQ1QzQixJQUFPLG9CQUNQNEIsS0FBUUgsRUFDUkksYUFBZSxFQUNmQyxhQUFlLEVBQ2Y3QixRQUFXLFNBQVVDLEdBQ2pCLEdBQXVCLE1BQW5CQSxFQUFhLEtBQVcsQ0FDeEIsSUFBSUYsRUFBTUUsRUFBYSxLQUFPLElBQzlCa0IsRUFBTVcsS0FBSyxNQUFPL0IsVUFPdENQLFFBQVFDLFVBQVVxQixxQkFBdUIsU0FBVUgsR0FDaENBLEVBQVdDLEtBQUssY0FDdEJLLE1BQU0sV0FDWGMsUUFBUUMsSUFBSSxvQkFDWnJCLEVBQVdzQixZQUluQnpDLFFBQVFDLFVBQVVzQixtQkFBcUIsU0FBVUosR0FDN0MsSUFBSXVCLEVBQVV2QixFQUFXQyxLQUFLLGFBQzFCdUIsRUFBV3hCLEVBQVdDLEtBQUssY0FDM0J3QixFQUFjekIsRUFBV0MsS0FBSywwQkFDOUJ5QixFQUFZMUIsRUFBV0MsS0FBSyx5QkFDNUIwQixFQUFlM0IsRUFBV0MsS0FBSywwQkFDbkNzQixFQUFRakIsTUFBTSxXQUNWLElBQUlzQixFQUFZSixFQUFTTCxLQUFLLE9BQzFCVSxFQUFXSixFQUFZSyxNQUN2QkMsRUFBVUwsRUFBVUksTUFDeEI1QyxRQUFRNkIsS0FBSyxDQUNUM0IsSUFBTyxtQkFDUDRCLEtBQVEsQ0FDSlksVUFBYUEsRUFDYkMsU0FBWUEsRUFDWkUsUUFBV0EsR0FFZjFDLFFBQVcsU0FBVUMsR0FDakIsR0FBdUIsTUFBbkJBLEVBQWEsS0FBVyxDQUNUQSxFQUFhLEtBQWEsVUFDekNxQyxFQUFhSyxLQUFLLE9BQVNILEdBQzNCSSxPQUFPQyxXQUFXQyxZQUFZLG1CQU9sRHRELFFBQVFDLFVBQVVzRCxJQUFNLFdBQ3BCbkQsS0FBS29CLHVCQUNMcEIsS0FBS0YsWUFHVGUsRUFBRSxZQUNnQixJQUFJakIsU0FDVnVEIiwiZmlsZSI6ImJhbm5lci5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBCYW5uZXJzKCkge1xyXG5cclxufVxyXG5cclxuQmFubmVycy5wcm90b3R5cGUubG9hZERhdGEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB4ZnphamF4LmdldCh7XHJcbiAgICAgICAgJ3VybCc6ICcvY21zL2Jhbm5lcl9saXN0LycsXHJcbiAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYmFubmVycyA9IHJlc3VsdFsnZGF0YSddO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiYW5uZXJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJhbm5lciA9IGJhbm5lcnNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRwbCA9IHRlbXBsYXRlKFwiYmFubmVyLWl0ZW1cIiwge1wiYmFubmVyXCI6IGJhbm5lcn0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBiYW5uZXJMaXN0R3JvdXAgPSAkKFwiLmJhbm5lci1saXN0LWdyb3VwXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJhbm5lckxpc3RHcm91cC5hcHBlbmQodHBsKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYmFubmVySXRlbSA9IGJhbm5lckxpc3RHcm91cC5maW5kKFwiLmJhbm5lci1pdGVtOmxhc3RcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hZGRJbWFnZVNlbGVjdEV2ZW50KGJhbm5lckl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWRkUmVtb3ZlQmFubmVyRXZlbnQoYmFubmVySXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hZGRTYXZlQmFubmVyRXZlbnQoYmFubmVySXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KVxyXG59O1xyXG5cclxuXHJcblxyXG5CYW5uZXJzLnByb3RvdHlwZS5saXN0ZW5BZGRCYW5uZXJFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBhZGRCdG4gPSAkKFwiI2FkZC1iYW5uZXItYnRuXCIpO1xyXG4gICAgYWRkQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdHBsID0gdGVtcGxhdGUoXCJiYW5uZXItaXRlbVwiKTtcclxuICAgICAgICB2YXIgYmFubmVyTGlzdEdyb3VwID0gJChcIi5iYW5uZXItbGlzdC1ncm91cFwiKTtcclxuICAgICAgICBiYW5uZXJMaXN0R3JvdXAucHJlcGVuZCh0cGwpO1xyXG5cclxuICAgICAgICB2YXIgYmFubmVySXRlbSA9IGJhbm5lckxpc3RHcm91cC5maW5kKFwiLmJhbm5lci1pdGVtOmZpcnN0XCIpO1xyXG4gICAgICAgIHNlbGYuYWRkSW1hZ2VTZWxlY3RFdmVudChiYW5uZXJJdGVtKTtcclxuICAgICAgICBzZWxmLmFkZFJlbW92ZUJhbm5lckV2ZW50KGJhbm5lckl0ZW0pO1xyXG4gICAgICAgIHNlbGYuYWRkU2F2ZUJhbm5lckV2ZW50KGJhbm5lckl0ZW0pO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5CYW5uZXJzLnByb3RvdHlwZS5hZGRJbWFnZVNlbGVjdEV2ZW50ID0gZnVuY3Rpb24gKGJhbm5lckl0ZW0pIHtcclxuICAgIHZhciBpbWFnZSA9IGJhbm5lckl0ZW0uZmluZCgnLnRodW1ibmFpbCcpO1xyXG4gICAgdmFyIGltYWdlSW5wdXQgPSBiYW5uZXJJdGVtLmZpbmQoJy5pbWFnZS1pbnB1dCcpO1xyXG4gICAgLy/lm77niYfmmK/kuI3og73miZPlvIDmlofku7bpgInmi6nmoYbnmoTvvIzlj6rog73pgJrov4dJTnB1dCh0eXBlPWZpbGUpXHJcbiAgICBpbWFnZS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaW1hZ2VJbnB1dC5jbGljaygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaW1hZ2VJbnB1dC5jaGFuZ2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBmaWxlID0gdGhpcy5maWxlc1swXTtcclxuICAgICAgICB2YXIgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcclxuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoXCJmaWxlXCIsIGZpbGUpO1xyXG4gICAgICAgIHhmemFqYXgucG9zdCh7XHJcbiAgICAgICAgICAgICd1cmwnOiAnL2Ntcy91cGxvYWRfZmlsZS8nLFxyXG4gICAgICAgICAgICAnZGF0YSc6IGZvcm1EYXRhLFxyXG4gICAgICAgICAgICAncHJvY2Vzc0RhdGEnOiBmYWxzZSxcclxuICAgICAgICAgICAgJ2NvbnRlbnRUeXBlJzogZmFsc2UsXHJcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdFsnY29kZSddID09PSAyMDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gcmVzdWx0WydkYXRhJ11bJ3VybCddO1xyXG4gICAgICAgICAgICAgICAgICAgIGltYWdlLmF0dHIoJ3NyYycsIHVybCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSk7XHJcbn07XHJcblxyXG5CYW5uZXJzLnByb3RvdHlwZS5hZGRSZW1vdmVCYW5uZXJFdmVudCA9IGZ1bmN0aW9uIChiYW5uZXJJdGVtKSB7XHJcbiAgICB2YXIgY2xvc2VCdG4gPSBiYW5uZXJJdGVtLmZpbmQoJy5jbG9zZS1idG4nKTtcclxuICAgIGNsb3NlQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcImNsb3NlIGJhbm5lcklUZW1cIik7XHJcbiAgICAgICAgYmFubmVySXRlbS5yZW1vdmUoKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuQmFubmVycy5wcm90b3R5cGUuYWRkU2F2ZUJhbm5lckV2ZW50ID0gZnVuY3Rpb24gKGJhbm5lckl0ZW0pIHtcclxuICAgIHZhciBzYXZlQnRuID0gYmFubmVySXRlbS5maW5kKCcuc2F2ZS1idG4nKTtcclxuICAgIHZhciBpbWFnZVRhZyA9IGJhbm5lckl0ZW0uZmluZCgnLnRodW1ibmFpbCcpO1xyXG4gICAgdmFyIHByaW9yaXR5VGFnID0gYmFubmVySXRlbS5maW5kKFwiaW5wdXRbbmFtZT0ncHJpb3JpdHknXVwiKTtcclxuICAgIHZhciBsaW5rdG9UYWcgPSBiYW5uZXJJdGVtLmZpbmQoXCJpbnB1dFtuYW1lPSdsaW5rX3RvJ11cIik7XHJcbiAgICB2YXIgcHJpb3JpdHlTcGFuID0gYmFubmVySXRlbS5maW5kKCdzcGFuW2NsYXNzPVwicHJpb3JpdHlcIl0nKTtcclxuICAgIHNhdmVCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBpbWFnZV91cmwgPSBpbWFnZVRhZy5hdHRyKCdzcmMnKTtcclxuICAgICAgICB2YXIgcHJpb3JpdHkgPSBwcmlvcml0eVRhZy52YWwoKTtcclxuICAgICAgICB2YXIgbGlua190byA9IGxpbmt0b1RhZy52YWwoKTtcclxuICAgICAgICB4ZnphamF4LnBvc3Qoe1xyXG4gICAgICAgICAgICAndXJsJzogJy9jbXMvYWRkX2Jhbm5lci8nLFxyXG4gICAgICAgICAgICAnZGF0YSc6IHtcclxuICAgICAgICAgICAgICAgICdpbWFnZV91cmwnOiBpbWFnZV91cmwsXHJcbiAgICAgICAgICAgICAgICAncHJpb3JpdHknOiBwcmlvcml0eSxcclxuICAgICAgICAgICAgICAgICdsaW5rX3RvJzogbGlua190b1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJhbm5lcklkID0gcmVzdWx0WydkYXRhJ11bJ2Jhbm5lcl9pZCddO1xyXG4gICAgICAgICAgICAgICAgICAgIHByaW9yaXR5U3Bhbi50ZXh0KFwi5LyY5YWI57qn77yaXCIgKyBwcmlvcml0eSk7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MoJ+i9ruaSreWbvua3u+WKoOWujOaIkO+8gScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH0pO1xyXG59O1xyXG5cclxuQmFubmVycy5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5saXN0ZW5BZGRCYW5uZXJFdmVudCgpO1xyXG4gICAgdGhpcy5sb2FkRGF0YSgpO1xyXG59O1xyXG5cclxuJChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgYmFubmVycyA9IG5ldyBCYW5uZXJzKCk7XHJcbiAgICBiYW5uZXJzLnJ1bigpO1xyXG59KTsiXX0=
